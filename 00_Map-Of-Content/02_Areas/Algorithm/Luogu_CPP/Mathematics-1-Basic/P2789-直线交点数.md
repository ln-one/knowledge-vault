---
tags:
  - Knowledge/Algorithm
created: 2025-09-10
author:
  - ln1
status: In Progress
---
## Description

假设平面上有 N 条直线，且无三线共点，那么这些直线有多少种可能的交点数？
### Example:  
Input: 
```
4
```

Output: 
```
5
```
## Question Link

[P2789 直线交点数 - 洛谷](https://www.luogu.com.cn/problem/P2789)
## Approach

- 那么这N条直线可以分为R条平行的，然后剩下的（N-R)条线不平行，所以一定会与R条平行的线有R*(N-R)个交点。
- 接着讨论剩下的(N-R)条线条，同样，它们又必然可分为平行的线和不平行的线，一直递归。直到剩下的线条数目为0。
- 线条数目为0后考虑：如果当前交点数没有存在过，则ans++，然后标记该交点数存在过。

## Implementation

```cpp
#include <iostream>

using namespace std;

const int MAXN = 10010;
bool isPossible[MAXN];
int n;
int ans;

void lineNum(int p, int r) { // p:num of lines   r:remained cross points num
  if (p == 0) {
    if (!isPossible[r]) {
      ans++;
      isPossible[r] = true;
      return;
    }
  } else {
    for (int i = p; i >= 1; i--) { // i:num of parallel lines
      lineNum(p - i, (p - i) * i + r);
    }
  }
}

int main() {
  ios::sync_with_stdio(false);
  cin.tie(nullptr);

  cin >> n;
  lineNum(n, 0);
  cout << ans << endl;
  return 0;
}
```

## Analysis
**关键在于将线条分为两种情况：**
- 目前平行的线条，这些线条剔除递归队列。
- 剩下的线条，进入递归，又分为两种情况。