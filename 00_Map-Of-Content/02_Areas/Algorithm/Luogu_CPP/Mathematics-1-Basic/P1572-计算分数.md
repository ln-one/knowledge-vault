---
tags:
  - Knowledge/Algorithm
  - Knowledge/Algorithms/Math
created: 2025-09-24
author:
  - ln1
status: In Progress
---
## Description

编写一个程序，接收一个由分数组成的加减表达式（例如 `2/1+1/3-1/4`），并输出其计算结果。结果必须是最简分数或整数形式。
### Example:  
Input: 
```
2/1+1/3-1/4
```

Output: 
```
25/12
```
## Question Link

[P1572 计算分数 - 洛谷](https://www.luogu.com.cn/problem/P1572)
## Approach

- 首先我们要解析表达式，根据表达式存入数据并进行操作；
- 我们把数字始终分为两部分，一部分是当前的分数，一部分是新添加的分数。初始的当前分数是`0/1`,然后我们现在识别了一个新的数字`a/b`，那么我们试图将这两部分相加。
- 首先将两个数使用最小公倍数`lcm`进行通分，将分子相加。
- 然后再处理完所有数字之后，将最后的结果的分子和分母进行除以最大公倍数`gcd`进行化简。若分母为1, 则为整数直接输出分子。

## Implementation

```cpp
#include <iostream>
#include <string>

using namespace std;
typedef long long ll;

ll gcd(ll a, ll b) {
  while (b != 0) {
    ll t = a % b;
    a = b;
    b = t;
  }
  return a;
}

int main() {
  string s;
  cin >> s;

  ll num = 0, den = 1; // initial result = 0/1;
  int i = 0, sign = 1;

  if (s[0] == '-') {
    int i = 1, sign = -1;
  }
  while (i < s.size()) {
    ll a = 0, b = 0;

    while (isdigit(s[i]))
      a = a * 10 + (s[i++] - '0');
    i++;
    while (isdigit(s[i]))
      b = b * 10 + (s[i++] - '0');

    ll lcm = den / gcd(den, b) * b;
    num = num * (lcm / den) + sign * a * (lcm / b);
    den = lcm;

    if (i < s.size()) {
      sign = (s[i] == '+') ? 1 : -1;
      i++;
    }
  }

  ll g = gcd(abs(num), den);
  num /= g;
  den /= g;

  if (den == 1)
    cout << num << endl;
  else
    cout << num << "/" << den << endl;

  return 0;
}

```

## Analysis
#### 1.最小公倍数公式:
$$
\mathrm{lcm}(a, b) = \frac{a \times b}{\gcd(a, b)}
$$
#### 2.分数相加公式:
$$
\frac{num}{den} \;\; \pm \;\; \frac{a}{b} 
= \frac{num \times \frac{lcm}{den} \;\; \pm \;\; a \times \frac{lcm}{b}}{lcm}
$$
**有关公约数公倍数的题目**:
- [[P1029-最大公约数和最小公倍数问题]]
- [[P1072-Hankson 的趣味题]]
