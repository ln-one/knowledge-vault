# 第四章 自由曲线与曲面（二）


# 本章内容

## • 概述

## • 参数曲线基础

## • 参数多项式曲线

## • 三次 Hermite 曲线

## • Bezier 曲线

## • B 样条曲线

## • 非均匀有理 B 样条曲线

## • Bézier 曲面和 B 样条曲面


# 外形设计的要求与特点

## • 初始给定的型值点不精确，不必点点通过

## • 性能、美观、自由度大

## • 画家是如何画汽车的？


# Bézier 曲线（ 1 / 20 ）

- **1962** 年，法国雷诺汽车公司， **P.E. Bézier** 工程师
    - 以“逼近”为基础的参数曲线
    - 设计系统 **UNISURF**
- **1972** 年雷诺汽车公司正式使用
- **1956** 年，法国雪铁龙汽车公司， **de Casteljau** 算法
- **Flash** 的绘图工具，运动路径
- 北大方正，字型的轮廓线


# Bézier 曲线（ 2 / 20 ）

###### ( ) ( ) [ 0 , 1 ]

```
0
```
##   , 

```

```
###### P t P BEZ t t

```
n
```
```
i
```
```
i i n
```

# Bézier 曲线（ 3 / 20 ）

### 퐵��,�(�) = �(�,�) ��( 1 − �)�−�, � ∈ [ 0 , 1 ]

### �(�,�) =

### �!

### �!(� − �)!

### = ���

```
2 次B�^23 次B�^3
```
```
t 1 t 1
```
```
�(�)=
�=�
```
```
�
��⋅푩��,�(�)
```

# Bézier 曲线（ 4 / 20 ）

### P ( t )| t  0  P 0 P ( t )| t  1  Pn


# Bézier 曲线（ 5 / 20 ）

- 端点切矢量
    - 导数曲线

```
�′(�)|�= 0 = �(� 1 − � 0 ) �′(�)|�= 1 = �(�� − ��− 1 )
```
#### ( ) ( ) ( ) [ 0 , 1 ]

```
1
```
```
0
```
##    1   , 1 

```

```
```

```
#### P t n P  P BEZ  t t

```
n
```
```
i
```
```
i i i n
```
```
�(�)=
�=�
```
```
�
��⋅푩��,�(�)
```

# Bézier 曲线（ 6 / 20 ）


# Bézier 曲线（ 7 / 20 ）


# Bézier 曲线（ 8 / 20 ）


# Bézier 曲线（ 9 / 20 ）

- 拟局部性 – 形状的易控性


# Bézier 曲线（ 10 / 20 ）

## • 二次 Bézier 曲线

- n = 2 抛物线

```
2
```
```
基函数
```
```
P 0 P^2
```
```
P 1
```
```
M
```
```
P( 0. 5 )
```
```
P( 0 ) P(^1 )
```
红点为线段中点，P( 0. 5 )处切线平行于P 0 P 2 t 1


# Bézier 曲线（ 11 / 20 ）

## • 三次 Bézier 曲线

- n = 3

```
基函数
P 0
```
```
P 1
```
```
P 2
```
```
P 3
```
P( 0 ) P( 1 )

```
P 1 通过基函数在t= 1 / 3 时对形状影响最大；
P 2 通过基函数在t= 2 / 3 时对形状影响最大。 t 1
```

# Bézier 曲线（ 12 / 20 ）

- 高次（ **_n_** **> 3** ） **Bézier** 曲线
    - 计算比较复杂
    - **de Casteljau** 算法能有效避开复杂的高次多项式求解过程，
       曲线生成效率较高
- **de Casteljau (** 德卡斯特里奥 **)** 递推算法
    - 基于分割递推的任意阶次 **Bézier** 曲线的离散生成算法
    - 基本问题：给定参数� ，计算�(�)

```
t
```
```
P ( t )
```
## t

##### P ( t )


# Bézier 曲线（ 13 / 20 ）

## • 几何作图过程

- 给定 **t** ，按 **t:( 1 −t)** 找到一组分点组成 **n− 1** 边形
- 重复上述操作，得到另一组分点
- 连续作 **n** 次，直到只剩下一个点为止

```
曲线上参数取值为 t 的型值点
```
```
t = 0. 5
```

# Bézier 曲线（ 14 / 20 ）

###### 

###### 

###### 

######       

###### 

######  

```

```
###### t P  t P r n i n r

###### P r

###### P r

```
i
```
```
r
i
```
```
r i
```
###### i ( 1 ) 1 , 2 , , , 0 , 1 , ,

###### , 0

```
1
1
```
(^1)  


# Bézier 曲线（ 15 / 20 ）

- 只要令 **_t_** 在 **[ 0** ， **1 ]** 间按一定步

### 长依次取值，即可求得 n 次

### Bézier 曲线上对应不同 t 值的

### 型值点


# Bézier 曲线（ 16 / 20 ）

## • 高次（ n> 3 ） Bézier 曲线

- 为简化计算通常由低阶次的 **Bézier** 曲线段拼接而成

## • 曲线的拼接

- 衔接点处，要达到一定的连续性要求

##  

```
m
i i im
```
```
P t P BEZ t
0 ,
```
## ( ) ( ) 

```

```
```
 
```
```
n
j j in
```
```
Q s Q BEZ s
0 ,
```
```
( ) ( )
```

# Bezier 曲线（ 17 / 20 ）

- ���条件 **——** 首尾简单衔接

### �� = � 0

( 2 ) (^) ∃� > 0 �� − ��− 1 = �(� 1 − � 0 )
三点共线，且 **_Q_** **1** **_, Pm-_** **1** 在连接点的异侧

- ���条件 **——** 衔接点处切向连续

### ( 1 ) �� = � 0


# Bezier 曲线（ 18 / 20 ）

- ���条件 **——** 衔接点处曲率相等

### ( 3 ) Q 2 P 1 与 Q 1 P 2 平行，且前者的

### 长度为后者的 2 倍

```
Q 2  P 1  2 ( Q 1  P 2 )
```
( 2 ) (^) ∃� > 0 �� − ��− 1 = �(� 1 − � 0 )
三点共线，且 **_Q_** **1 ,** **_Pm_** **- 1** 在连接点的异侧

### ( 1 ) �� = � 0


## • 反求控制点 Pi

- 给定 **n+ 1** 个型值点 **_Qi_**
- 要求构造一条通过这些型值点的 **Bézier** 曲线

# Bezier 曲线（ 19 / 20 ）















```

```
```
     
```
```


```
```
n n
```
```
i n n n n n nn n
Q P
```
```
Q PC i n PC i n i n PC i n
```
```
Q P
```
```
...
```
```
( 1 / ) ( 1 / ) ( / ) ... ( / )
```
```
...
0 0 1 1 1
```
```
0 0
```
```
P 0
```
```
P 1
```
```
P n
Q 0
```
```
Q 1
Q n
方程联立求解
```

- 优点：
    - 形状控制直观，设计灵活，应用较为广泛
       - **TrueType** 字型就使用了 **Bézier** 曲线

# Bezier 曲线（ 20 / 20 ）


# Q & A


# 本章内容

## • 概述

## • 参数曲线基础

## • 参数多项式曲线

## • 三次 Hermite 曲线

## • Bézier 曲线

## • B 样条曲线

## • 非均匀有理 B 样条曲线

## • Bézier 曲面和 B 样条曲面


# B 样条曲线（ 1 / 21 ）

- 产生：
    - **1946** 年， **Schoenberg** 发表关于 **B** 样条函数的论文
    - **1973** 年前后， **Gordon, Riesenfield, Forrest** 等人受到
       **Bézier** 方法的启发，将 **B** 样条函数拓广成参数形式的 **B** 样
       条曲线
- 优于 **Bézier** 曲线之处：
    - 阶次低，与型值点数无关，计算简便
    - 局部修改能力强
    - 任意形状，包括尖点、直线
    - 易于拼接
    - 与控制多边形的外形更接近


# B 样条曲线（ 2 / 21 ）

```
规定 0 / 0 = 0
```

# B 样条曲线（ 3 / 21 ）

- **m+n+ 1** 个控制点可生成 **m+ 1** 段 **n** 次 **B** 样条曲线
- 为简化记号，取 **_i_** **= 0** 来代表样条中的任意一段

## 

```

```
```
  
```
```
n
k
```
```
P t PkBk n t t
0
```
```
( ) , ( ) 0 1
```

# B 样条曲线（ 4 / 21 ）

```
B 0 , 2 ( t ) 21 ( t^2  2 t  1 )
```
```
B 1 , 2 ( t ) 21 ( 2 t^2  2 t  1 )
```
```
2 , 2 2
2
B ( t ) ^1 t
```
######  

```

```
```

```
```


```
```

```
```

```
```

```
```


```
```

```
```

```
```

```
```


```
```

```
```

```
```

```
```


```
```


```
(^0122)
1
0 0 1
1 2 - 2
1 - 2 1
2
(t)^1
_t
P P P P t_
� 0
� 1
� 2
�( 0 ) �(^1 )
�′( 0. 5 )
��
�( 0. 5 )


# B 样条曲线（ 5 / 21 ）

```
B 0 , 3 ( t ) 61 ( t^3  3 t^2  3 t  1 )
```
```
B 1 , 3 ( t ) 61 ( 3 t^3  6 t^2  4 )
```
```
B 2 , 3 ( t ) 61 ( 3 t^3  3 t^2  3 t  1 )
```
```
B 3 , 3 ( u ) 61 t
```
```
 




```
```

```
```

```
```




```
```

```
```

```
```




```
```

```
```

```
```




```
```

```
```


3
```
(^01232)
1
0 0 0 1
1 3 3 - 3
4 0 - 6 3
1 - 3 3 - 1
6
(t)^1
_t
t
P P P P P t_
� (^0) � 3
� 1
� 2
�(�)
�( 0 ) �(^1 ) �′(^1 )
�′( 0 )
��
��


# B 样条曲线（ 6 / 21 ）

..

```
P(^0 )
```
P( (^1) )
,
P 1 P( 1 ) ,
P 0
P 2
P 3
P( 0 )
P(μ)

..
.
..

```
.
```
```
Pm Pn
P(t)
```
```
P 4
```

# B 样条曲线（ 7 / 21 ）

```
B 样条与控制多边形的外形更接近
```

# B 样条曲线（ 8 / 21 ）

## • 三次 B 样条的特殊外形设计

- 三顶点共线
- 位于控制多边形边上的一个点

```
P 0 P 2
```
```
P 1
```
```
Pm
```
```
P( 0 ) P’(^0 )
```
```
P 0 Pm P( 0 ) P 1 P 2
```

# B 样条曲线（ 9 / 21 ）

## • 特殊外形设计

- 四顶点共线
- 直线段

```
P 0 P 1 P 2 P 3
```
```
P( 0 ) P( 1 )
Pm 1 Pm 1
```

# B 样条曲线（ 10 / 21 ）

## • 特殊外形设计

- 两顶点重合

```
P 0 P^2
```
```
P 1
P’( 0 )
```
```
P 0
```
```
P 1 P 2
```
```
P( 0 )
```
```
P( 0 )
```
```
Pm
```
```
Pm
```
## ?


# B 样条曲线（ 11 / 21 ）

## • 特殊外形设计

- 两顶点重合
- 相切于控制多边形边的曲线
    P 2

```
P 5
```
```
P 1
```
```
P 0
```
```
P 4
```
```
P 3
P 0
P 1 P 3
```
```
P( 0 ) P( 1 ) P^2
```
```
二重顶点构造直线段
```

# B 样条曲线（ 12 / 21 ）

## • 特殊外形设计

- 三顶点重合
- 含有直线段、尖点的曲线
    P 2

```
P 6
```
```
P 1
```
```
P 0
```
```
P 3 P 4
```
```
P 5
```
```
直线段
```

# B 样条曲线（ 13 / 21 ）

## • 特殊外形设计

- 如何构造通过控制多边形某一顶点的 **B** 样条曲线？

## • 方法：

- 将控制多边形的首尾两条边各延长其 **1 / 5** （延长段为总的
    **1 / 6** ），将新的顶点置为二重顶点
- 将控制多边形的首尾两条边各延长其 **1** 倍，利用三点共线


# B 样条曲线（ 14 / 21 ）

## • 在数据拟合中的应用

- 给定一组离散的型值点，如何构造一条通过该组型值点
    的 **B** 样条曲线？

## • 原问题

- 给定控制点��，计算曲线上的点�� (�)

## 

```

```
```
  
```
```
n
k
```
```
P t PkBk n t t
0
```
```
( ) , ( ) 0 1
```
## • 反算拟合问题

- 已知型值点�� (�) ，计算控制点��


# B 样条曲线（ 15 / 21 ）

- 目标：构造三次 **B** 样条曲线通过型值点 **Qi, i= 0 , 1 , ..., n- 3**
- 反求控制顶点 **Pm, m= 0 , 1 , ...**
- 根据三次 **B** 样条曲线端点性质
- 补充两个边界条件 **——** 首末两个端点的切矢量

```
追赶法求解
```
```
三对角方程组
```
```
��, 3 (�)=
�= 0
```
```
3
��+�퐵�, 3 (�), 0 ≤�≤ 1
```
```
令
```

# B 样条曲线（ 16 / 21 ）


# B 样条曲线（ 17 / 21 ）

- **Su Xiaohong, Li Dong, Zhang Tianwen. A new method to**
    **build boundary conditions for nonuniform B-splines**
    **interpolation. Journal of Harbin Institute of Technology (In**
    **English). 2000 , 7 ( 4 ): 59 - 62**
- 苏晓红，李东，王宇颖．基于曲率参数的 **NURBS** 曲线插
    值．哈尔滨工业大学学报， **2001 , 1 , 33 ( 1 ): 108 - 111**
- 提出一种新的边界条件构造方法，通过两端点内曲线的曲
    率来构造端点曲率，从而获得边界条件，亦可称为“构造
    曲率法”，可以有效避免端点的“零曲率”现象（ **P 100 - 101** ）


# B 样条曲线（ 18 / 21 ）

## • 依节点向量的不同取值，可将 B 样条曲线分为

- 均匀 **B** 样条曲线
    - 均匀周期性节点（等距节点）
- 准均匀 **B** 样条曲线
    - 均匀非周期节点
- 非均匀 **B** 样条曲线
    - 不等距节点

```
��,�(�)=
�=�
```
```
�
��+�푩�,�(�), ��−�≤�≤��+�
```
```
�+�+�个节点
```

# B 样条曲线（ 19 / 21 ）

- 均匀 **B** 样条曲线
    - 均匀周期性节点（等距节点）
    - 一般地，节点向量取值范围为 **[ 0 , 1 ]**
       - 例如， **{ 0 , 0. 2 , 0. 4 , 0. 6 , 0. 8 , 1 }**
    - 方便起见，常取初始值为 **0** 、间距为 **1**
       的均匀整数节点向量
          - **{ 0 , 1 , 2 , ..., n+k}**
    - 使得均匀 **B** 样条基函数具有周期性的
       特点，后面的基函数仅仅是对前一个
       基函数的水平移位


# B 样条曲线（ 20 / 21 ）

- 准均匀 **B** 样条曲线
    - 均匀非周期节点（准均匀节点分布）
    - 所有内节点都是等距分布，仅在首末两端具有 **_k_** 重复度

```
仅两端 k − 2 个节点区间不同 当形 k 状^ = 控^ n 制 +^1 具时有转更化大为的 Bé 灵 zie 活 r 曲性线
```

# B 样条曲线总结（ 21 / 21 ）


# Q & A


# 本章内容

## • 概述

## • 参数曲线基础

## • 参数多项式曲线

## • 三次 Hermite 曲线

## • Bézier 曲线

## • B 样条曲线

## • 非均匀有理 B 样条曲线

## • Bézier 曲面和 B 样条曲面


## 有理样条（ Rational Spline ）

- **1983** 年， **Tiller** 利用齐次坐标技术，将 **B** 样条曲线的

### 定义推广到用四维齐次坐标表示

- 得到四维齐次坐标系下的有理 **B** 样条曲线定义为
- 对应于三维空间中的有理 **B** 样条曲线定义为
- 有理：分子分母分别是参数多项式与多项式函数的分式表示

```
( ) 0 , ( )
```
```
n
```
#### Q w t  i  P wiBik t

```
0 ,
0 ,
0 ,
```
```
( )
() ()
()
```
```
n
i i i ik n
n i i ik
i i ik
```
```
w B t
t R t
wB t
```
```



```
```
 
```
###### 

###### 

###### 

```
P
P P
```
```
P i ( xi , yi , zi ) P wi ( wixi , wiyi , wizi , wi )
```
```
, ,
0 ,
```
```
( ) ( )
( )
```
```
ik n i ik
j j jk
```
```
R t wB t
w B t

```
```

```
### 


## 非均匀有理 B 样条曲线（ NURBS ）

- 若有理 **B** 样条的节点分布是均匀的，则称均匀有理 **B** 样条曲线
- 若节点分布是非均匀的，则称非均匀有理 **B** 样条曲线
    （ **Nonuniform Rational B-splines** ， **NURBS** ）
- **NURBS** 方法的提出
    - **B** 样条方法不能精确表示除抛物面外的二次曲面，只能给出近似表示
    - 在飞机外形设计和绝大多数机械零件中，常遇到许多由二次曲线弧和
       二次曲面表示的形状
          - 如机身框截面外形曲线，叶轮既包含自由型曲面，也包含二次曲面
- 主要理由
    - 为了找到既能与描述自由型曲线曲面的 **B** 样条方法相统一，又能精确
       表示二次曲线弧和二次曲面的数学方法


## 非均匀有理 B 样条曲线（ NURBS ）

- **1991** 年，国际标准化组织（ **ISO** ）正式颁布了工业

### 产品几何定义的 STEP 标准

- 作为产品数据交换的国际标准
- 将 **NURBS** 作为定义工业产品形状的唯一数学方法
- **NURBS** 是 **CAD** 几何造型和建模的重要方法
- 目前很多 **CAD** 商品软件都具有 **NURBS** 功能
- 建立在非有理 **Bézier** 和非有理 **B** 样条基础上
- 用 **NURBS** 曲线表示二次曲线的方法
- **3** 个控制顶点，二次 **B** 样条
- 均匀节点向量 **{ 0 , 0 , 0 , 1 , 1 , 1 }**
- 权因子

```
0 ,
0 ,
0 ,
```
```
()
() () ()
```
```
n i i ik
i n i ik
n i ik i
i
```
```
w B t
t  wB t  R t

```
```
 

```
```
P
P P
```
```
w 1 ＞ 1
w 1 = 1
w 1 < 1
w 1 = 0
```

## 非均匀有理 B 样条曲线（ NURBS ）

优点：

- 对标准曲面（如圆锥曲线、二次曲面、回转面等）和自由
    曲线曲面提供了统一的数学表示，便于用一个统一的数据
    库来存取这两类形状信息
       - 非有理 **B** 样条、有理及非有理 **Bézier** 曲线曲面是 **NURBS** 的特例
- 具有更多的形状控制自由度（控制点，节点向量，权因子）
- 在平移、比例、旋转和透视投影变换下是不变的

缺点：

- 比一般的曲线、曲面定义方法更费存储空间和处理时间
- 权因子选择不当会造成形状畸变


# Q & A


