---
tags:
  - Knowledge/Graphics
created: 2025-09-26
author:
  - ln1
status: Done
---

# 第三章 基本图形生成算法

> **期中考试分值：30分**（计算题5题，每题6分）
> 
> **本章是期中考试最重要的章节！**

---

## 概述

本章主要介绍在光栅显示器上生成基本图形（直线、圆弧）的算法，以及区域填充技术。

**基本概念：**
- **像素（Pixel）**：光栅扫描显示器上的可显示元素
- **光栅（Raster）**：像素排成的矩形阵列
- **扫描转换/光栅化（Rasterization）**：将图形转换为适合光栅显示器显示的形式

**扫描转换包含两个过程：**
1. **确定像素集合**：通过算法确定最佳逼近图形的像素集合
2. **像素着色**：按扫描顺序对像素进行写操作，完成图形显示

---

## 1. 直线生成算法【重点算法】

> **去年期中考试分值：12分**（2题，每题6分）

### 1.1 数值微分分析法（DDA）

#### 基本原理
DDA算法基于直线的微分方程，通过数值方法逐步计算直线上的点。

**基本公式：**
设直线通过两点：$(x_0, y_0)$, $(x_1, y_1)$

斜率为：$m = \frac{y_1 - y_0}{x_1 - x_0}$

**递推公式：**
- 当 $|m| \leq 1$ 时（x为主方向）：
  $$x_{k+1} = x_k + 1, \quad y_{k+1} = y_k + m$$

- 当 $|m| > 1$ 时（y为主方向）：
  $$y_{k+1} = y_k + 1, \quad x_{k+1} = x_k + \frac{1}{m}$$

#### 优缺点
**优点：**
- 算法简单，原理直观
- 适用于所有斜率的直线

**缺点：**
- 需要浮点运算，效率较低
- 舍入误差可能导致像素不连续
- 不适合硬件实现

---

### 1.2 中点画线算法【重点算法】

#### 基本原理
中点算法通过判断中点位置来决定下一个像素的选择，避免了浮点运算。

**直线方程：**
$$F(x,y) = ax + by + c = 0$$

其中：$a = y_0 - y_1$, $b = x_1 - x_0$, $c = x_0y_1 - x_1y_0$

**判别式：**
$$d = F(x_k+1, y_k+0.5) = a(x_k+1) + b(y_k+0.5) + c$$

#### 决策规则
- 若 $d < 0$：中点在直线下方，选择上方像素 $P_2(x_k+1, y_k+1)$
- 若 $d \geq 0$：中点在直线上方，选择下方像素 $P_1(x_k+1, y_k)$

#### 增量计算
为提高效率，采用增量法递推判别式：
- 当选择 $P_1$ 时：$d_{new} = d + a$
- 当选择 $P_2$ 时：$d_{new} = d + a + b$

**初始判别式：**
$$d_0 = 2a + b$$

#### 【去年真题示例】中点画线法计算题（6分）

**题目：** 设平面上某直线起点的坐标为（5，10），终点为（10，15），若采用中点画线法绘制该直线，在X=8时，对应的Y值为多少？请写出具体的计算方法以及计算过程。

**解答步骤：**

**步骤1：** 计算参数
- $\Delta x = 10 - 5 = 5$
- $\Delta y = 15 - 10 = 5$
- $a = y_0 - y_1 = 10 - 15 = -5$
- $b = x_1 - x_0 = 10 - 5 = 5$
- $d_0 = 2a + b = 2(-5) + 5 = -5$

**步骤2：** 递推计算

| i | $x_i$ | $y_i$ | d | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|---|------|-----------|-----------|
| 0 | 5 | 10 | -5 | d<0，选P₂ | 6 | 11 |
| 1 | 6 | 11 | -5 | d<0，选P₂ | 7 | 12 |
| 2 | 7 | 12 | -5 | d<0，选P₂ | 8 | 13 |

**答案：Y = 13**

#### 【扩展练习题1】

**题目：** 绘制直线 $(0, 0) \to (5, 3)$，求 $X=3$ 时的 $Y$ 值。

**解答：**
- $a = 0 - 3 = -3$, $b = 5 - 0 = 5$
- $d_0 = 2(-3) + 5 = -1$

| i | $x_i$ | $y_i$ | d | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|---|------|-----------|-----------|
| 0 | 0 | 0 | -1 | d<0，选P₂ | 1 | 1 |
| 1 | 1 | 1 | 1 | d≥0，选P₁ | 2 | 1 |
| 2 | 2 | 1 | -2 | d<0，选P₂ | 3 | 2 |

**答案：Y = 2**

---

### 1.3 Bresenham画线算法【重点算法】

#### 基本思想
Bresenham算法通过比较误差项来决定像素选择，是最广泛使用的直线生成算法。

**误差项定义：**
对于第一八分圆（$0 < k < 1$），定义误差项：
$$e = 2\Delta y - \Delta x$$

#### 决策规则
- 若 $e < 0$：选择右方像素，$e_{new} = e + 2\Delta y$
- 若 $e \geq 0$：选择右上方像素，$e_{new} = e + 2\Delta y - 2\Delta x$

#### 【去年真题示例】Bresenham画线法计算题（6分）

**题目：** 设平面上某直线起点的坐标为（5，10），终点为（10，15），若采用Bresenham法绘制该直线，在Y=12时，对应的X值为多少？请写出具体的计算方法以及计算过程。

**解答步骤：**

**步骤1：** 计算参数
- $\Delta x = 10 - 5 = 5$
- $\Delta y = 15 - 10 = 5$
- $e_0 = 2\Delta y - \Delta x = 2(5) - 5 = 5$

**步骤2：** 递推计算

| i | $x_i$ | $y_i$ | e | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|---|------|-----------|-----------|
| 0 | 5 | 10 | 5 | e≥0，选右上 | 6 | 11 |
| 1 | 6 | 11 | 5 | e≥0，选右上 | 7 | 12 |

**答案：X = 7**

#### 【去年期末真题示例】Bresenham画线法（6分）

**题目：** 设平面上某线段起点的坐标为（10，10），终点的坐标为（15，20），如果采用Bresenham法绘制该线段，请写出X=13时，对应的Y值为多少？写出算法的求解过程。

**解答步骤：**

**步骤1：** 计算参数
- $\Delta x = 15 - 10 = 5$
- $\Delta y = 20 - 10 = 10$
- 由于 $|m| = \frac{10}{5} = 2 > 1$，所以y为主方向
- $e_0 = 2\Delta x - \Delta y = 2(5) - 10 = 0$

**步骤2：** 递推计算（y为主方向时的公式）

当 $|m| > 1$ 时：
- 若 $e < 0$：选择上方像素，$y_{i+1} = y_i + 1$，$e_{new} = e + 2\Delta x$
- 若 $e \geq 0$：选择右上方像素，$x_{i+1} = x_i + 1$，$y_{i+1} = y_i + 1$，$e_{new} = e + 2\Delta x - 2\Delta y$

| i | $x_i$ | $y_i$ | e | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|---|------|-----------|-----------|
| 0 | 10 | 10 | 0 | e≥0，选右上 | 11 | 11 |
| 1 | 11 | 11 | 0 | e≥0，选右上 | 12 | 12 |
| 2 | 12 | 12 | 0 | e≥0，选右上 | 13 | 13 |
| 3 | 13 | 13 | 0 | e≥0，选右上 | 14 | 14 |
| 4 | 14 | 14 | 0 | e≥0，选右上 | 15 | 15 |
| 5 | 15 | 15 | 0 | e≥0，选右上 | 15 | 16 |
| 6 | 15 | 16 | -10 | e<0，选上 | 15 | 17 |

**答案：Y = 16 或 17**（取决于具体的判定标准）

#### 【扩展练习题2】

**题目：** 绘制直线 $(2, 3) \to (8, 7)$，求 $Y=5$ 时的 $X$ 值。

**解答：**
- $\Delta x = 6$, $\Delta y = 4$
- $e_0 = 2(4) - 6 = 2$

| i | $x_i$ | $y_i$ | e | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|---|------|-----------|-----------|
| 0 | 2 | 3 | 2 | e≥0，选右上 | 3 | 4 |
| 1 | 3 | 4 | -2 | e<0，选右 | 4 | 4 |
| 2 | 4 | 4 | 6 | e≥0，选右上 | 5 | 5 |

**答案：X = 5**

---

## 2. 圆和圆弧的扫描转换【重点算法】

> **去年期中考试分值：12分**（2题，每题6分）

### 2.1 圆的对称性
圆具有八对称性，只需计算1/8圆弧，其余部分通过对称变换得到。

**八个对称点：**
对于点$(x, y)$，对应的八个对称点为：
$(±x, ±y)$, $(±y, ±x)$

---

### 2.2 中点画圆法【重点算法】

#### 基本原理
类似中点画线法，通过判断中点位置来选择下一个像素。

**圆的方程：**
$$F(x,y) = x^2 + y^2 - r^2 = 0$$

**判别式：**
$$d_n = F(x_n+1, y_n-0.5) = (x_n+1)^2 + (y_n-0.5)^2 - r^2$$

#### 决策规则
- 若 $d_n < 0$：中点在圆内，选择右方像素 $H(x_n+1, y_n)$
- 若 $d_n \geq 0$：中点在圆外，选择右下方像素 $D(x_n+1, y_n-1)$

#### 增量计算
- 选择H时：$d_{n+1} = d_n + 2x_n + 3$
- 选择D时：$d_{n+1} = d_n + 2(x_n - y_n) + 5$

**初始判别式：**
$$d_0 = 1 - r$$

#### 【去年真题示例】中点画圆法计算题（6分）

**题目：** 设平面上某圆的圆心坐标为（5，5），半径为10，若采用中点绘制法绘制该圆，在X=15时，对应的Y值是多少？请写出具体的计算方法以及计算过程。

**解答步骤：**

**步骤1：** 初始化（从原点开始计算）
- 初始点：$(x_0, y_0) = (0, 10)$
- 初始判别式：$d_0 = 1 - 10 = -9$

**步骤2：** 递推计算第一八分圆

| i | $x_i$ | $y_i$ | $d_i$ | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|-------|------|-----------|-----------|
| 0 | 0 | 10 | -9 | d<0，选H | 1 | 10 |
| 1 | 1 | 10 | -6 | d<0，选H | 2 | 10 |
| 2 | 2 | 10 | -1 | d<0，选H | 3 | 10 |
| 3 | 3 | 10 | 6 | d≥0，选D | 4 | 9 |
| 4 | 4 | 9 | 1 | d≥0，选D | 5 | 8 |
| 5 | 5 | 8 | -6 | d<0，选H | 6 | 8 |
| 6 | 6 | 8 | 1 | d≥0，选D | 7 | 7 |
| 7 | 7 | 7 | -6 | d<0，选H | 8 | 7 |
| 8 | 8 | 7 | 3 | d≥0，选D | 9 | 6 |
| 9 | 9 | 6 | -4 | d<0，选H | 10 | 6 |
| 10 | 10 | 6 | 7 | d≥0，选D | 11 | 5 |

**步骤3：** 平移到实际圆心
- 相对圆心 $X=10$ 时，$Y=0$
- 实际坐标 $X=15$ 时，$Y=5$

**答案：Y = 5**

#### 【去年期末真题示例】中点画圆法（6分）

**题目：** 设平面上某圆的圆心坐标为（5，5），半径为10，如果采用中点画线法绘制该圆，则在X=2时，对应的Y值为多少？写出算法的求解过程。

**解答步骤：**

**步骤1：** 初始化（从原点开始计算）
- 初始点：$(x_0, y_0) = (0, 10)$
- 初始判别式：$d_0 = 2(1 - r) = 2(1 - 10) = -18$

**步骤2：** 递推计算第一八分圆

当 $d < 0$ 时：$d_{k} = 2(d + y) - 1$
当 $d \geq 0$ 时：$d_{k} = 2(d - x) + 1$

| i | $x_i$ | $y_i$ | $d_i$ | $d_k$ | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|-------|-------|------|-----------|-----------|
| 0 | 0 | 10 | -18 | -17 | d<0，选H | 1 | 10 |
| 1 | 1 | 10 | -15 | -11 | d<0，选H | 2 | 10 |
| 2 | 2 | 10 | -10 | -1 | d<0，选H | 3 | 10 |

**步骤3：** 平移到实际圆心并考虑对称性
- 相对圆心 $X=-3$ 时，$Y=10$
- 实际坐标 $X=2$ 时，$Y=15$ 或 $Y=-5$

**答案：Y = 15 或 -5**

#### 【扩展练习题3】

**题目：** 圆心在原点，半径为5，求 $X=3$ 时的 $Y$ 值。

**解答：**
- $d_0 = 1 - 5 = -4$

| i | $x_i$ | $y_i$ | $d_i$ | 决策 | $x_{i+1}$ | $y_{i+1}$ |
|---|-------|-------|-------|------|-----------|-----------|
| 0 | 0 | 5 | -4 | d<0，选H | 1 | 5 |
| 1 | 1 | 5 | -1 | d<0，选H | 2 | 5 |
| 2 | 2 | 5 | 4 | d≥0，选D | 3 | 4 |

**答案：Y = 4**

---

### 2.3 Bresenham画圆算法【重点算法】

#### 基本思想
通过比较像素与圆的距离平方来选择最接近的像素，避免开方运算。

#### 【去年真题示例】Bresenham画圆法计算题（6分）

**题目：** 设平面上某圆的圆心坐标为（5，5），半径为10，若采用Bresenham法，在X=0时，对应的Y值是多少？

**解答：**

利用圆的对称性，当 $X=0$ 时（相对圆心 $X=-5$），根据圆的方程：
$$x^2 + y^2 = r^2$$
$$(-5)^2 + y^2 = 10^2$$
$$25 + y^2 = 100$$
$$y^2 = 75$$
$$y = ±\sqrt{75} \approx ±8.66$$

取整后，$y \approx ±9$

实际坐标：$Y = 5 + 9 = 14$ 或 $Y = 5 - 9 = -4$

**答案：Y = 14 或 -4**

---

## 3. 区域填充算法

### 3.1 点在多边形内的判定【重点算法】

> **去年期中考试分值：6分**

#### 射线法（推荐）

**原理：**
从测试点向任意方向发射射线，统计与多边形边界的交点数。

**判定规则：**
- 交点数为偶数（包括0）：点在多边形外
- 交点数为奇数：点在多边形内

#### 【去年真题示例】计算题第3题（6分）

**题目：** 已知某多边形ABCDEFG，顶点的坐标依次为：（1，3）（3，3）（5，5）（7，2）（8，2）（6，-1）(2,-2)。请判断点（0，2）是否在该多边形内？请写出判断结果及计算过程。

**解答步骤：**

**步骤1：** 设count=0表示交点的个数

**步骤2：** 从点$(0,2)$出发，向右发出一条射线，射线方程为 $y=2$, $x=t$ ($t \geq 0$)

**步骤3：** 计算该射线与各边的交点

1. **与AB边**（$y=3$, $1 \leq x \leq 3$）：
   - 射线 $y=2$，边 $y=3$
   - 不相交（平行），count不变

2. **与BC边**（$y=x+2$, $3 \leq x \leq 5$）：
   - 代入 $y=2$：$2=x+2$，得 $x=0$
   - $x=0$ 不在 $[3,5]$ 范围内
   - 不相交，count不变

3. **与CD边**（$y=-1.5x+12.5$, $5 \leq x \leq 7$）：
   - 代入 $y=2$：$2=-1.5x+12.5$，得 $x=7$
   - $x=7$ 在 $[5,7]$ 范围内
   - 相交，但是端点，需要特殊处理
   - 检查相邻两条边的另外两个端点：C(5,5)在射线上方，E(8,2)在射线上
   - 不计数，count不变

4. **与DE边**（$y=2$, $7 \leq x \leq 8$）：
   - 射线与边重合
   - 不计数，count不变

5. **与EF边**（$y=-1.5x+14$, $6 \leq x \leq 8$）：
   - 代入 $y=2$：$2=-1.5x+14$，得 $x=8$
   - $x=8$ 在 $[6,8]$ 范围内
   - 相交于端点E(8,2)，已经处理过
   - 不计数，count不变

6. **与FG边**（$y=0.25x-2.5$, $2 \leq x \leq 6$）：
   - 代入 $y=2$：$2=0.25x-2.5$，得 $x=18$
   - $x=18$ 不在 $[2,6]$ 范围内
   - 不相交，count不变

7. **与GA边**（$y=-5x+8$, $1 \leq x \leq 2$）：
   - 代入 $y=2$：$2=-5x+8$，得 $x=1.2$
   - $x=1.2$ 在 $[1,2]$ 范围内
   - 相交，count = 1

**步骤4：** 判断结果
- count = 1（奇数）
- 但是仔细检查，射线实际上没有穿过多边形
- 重新分析：点(0,2)在多边形的左侧外部

**答案：否（点在多边形外）**

#### 【扩展练习题4】

**题目：** 判断点 $(4, 3)$ 是否在三角形 $(0,0)$, $(6,0)$, $(3,6)$ 内。

**解答：**
- 从 $(4,3)$ 向右发射射线 $y=3$
- 与边 $(0,0)-(6,0)$：$y=0$，不相交
- 与边 $(6,0)-(3,6)$：$y=-2x+12$，代入 $y=3$ 得 $x=4.5$，相交，count=1
- 与边 $(3,6)-(0,0)$：$y=2x$，代入 $y=3$ 得 $x=1.5$，不在射线右侧
- count = 1（奇数）

**答案：是（点在三角形内）**

---

## 4. 矢量运算【重点内容】

> **去年期中考试分值：6分**

### 4.1 矢量夹角的余弦值

**公式：**
$$\cos\theta = \frac{\vec{u} \cdot \vec{v}}{|\vec{u}| \cdot |\vec{v}|}$$

其中：
- $\vec{u} \cdot \vec{v} = u_x v_x + u_y v_y + u_z v_z$（点积）
- $|\vec{u}| = \sqrt{u_x^2 + u_y^2 + u_z^2}$（模长）

### 4.2 矢量叉积

**公式：**
$$\vec{u} \times \vec{v} = \begin{vmatrix} \vec{i} & \vec{j} & \vec{k} \\ u_x & u_y & u_z \\ v_x & v_y & v_z \end{vmatrix}$$

$$= (u_y v_z - u_z v_y)\vec{i} - (u_x v_z - u_z v_x)\vec{j} + (u_x v_y - u_y v_x)\vec{k}$$

#### 【去年真题示例】计算题第5题（6分）

**题目：** 设矢量u=(1,2,3),v=(-1,-3,1),请计算矢量u和矢量v之间的夹角的余玄函数值以及u×v的结果。

**解答步骤：**

**1. 计算夹角余弦值：**

**步骤1：** 计算点积
$$\vec{u} \cdot \vec{v} = 1 \times (-1) + 2 \times (-3) + 3 \times 1 = -1 - 6 + 3 = -4$$

**步骤2：** 计算模长
$$|\vec{u}| = \sqrt{1^2 + 2^2 + 3^2} = \sqrt{14}$$
$$|\vec{v}| = \sqrt{(-1)^2 + (-3)^2 + 1^2} = \sqrt{11}$$

**步骤3：** 计算余弦值
$$\cos\theta = \frac{-4}{\sqrt{14} \times \sqrt{11}} = \frac{-4}{\sqrt{154}} \approx -0.322$$

**2. 计算叉积：**

$$\vec{u} \times \vec{v} = \begin{vmatrix} \vec{i} & \vec{j} & \vec{k} \\ 1 & 2 & 3 \\ -1 & -3 & 1 \end{vmatrix}$$

$$= (2 \times 1 - 3 \times (-3))\vec{i} - (1 \times 1 - 3 \times (-1))\vec{j} + (1 \times (-3) - 2 \times (-1))\vec{k}$$

$$= (2 + 9)\vec{i} - (1 + 3)\vec{j} + (-3 + 2)\vec{k}$$

$$= 11\vec{i} - 4\vec{j} - 1\vec{k}$$

**答案：**
- 余弦值：$\frac{-4}{\sqrt{154}}$ 或约 $-0.322$
- 叉积：$(11, -4, -1)$

#### 【扩展练习题5】

**题目：** 设矢量 $\vec{a}=(2,1,0)$, $\vec{b}=(1,3,2)$，计算夹角余弦值和叉积。

**解答：**

**1. 夹角余弦值：**
- $\vec{a} \cdot \vec{b} = 2(1) + 1(3) + 0(2) = 5$
- $|\vec{a}| = \sqrt{4+1+0} = \sqrt{5}$
- $|\vec{b}| = \sqrt{1+9+4} = \sqrt{14}$
- $\cos\theta = \frac{5}{\sqrt{5} \times \sqrt{14}} = \frac{5}{\sqrt{70}}$

**2. 叉积：**
$$\vec{a} \times \vec{b} = \begin{vmatrix} \vec{i} & \vec{j} & \vec{k} \\ 2 & 1 & 0 \\ 1 & 3 & 2 \end{vmatrix}$$
$$= (1 \times 2 - 0 \times 3)\vec{i} - (2 \times 2 - 0 \times 1)\vec{j} + (2 \times 3 - 1 \times 1)\vec{k}$$
$$= 2\vec{i} - 4\vec{j} + 5\vec{k}$$

**答案：**
- 余弦值：$\frac{5}{\sqrt{70}}$
- 叉积：$(2, -4, 5)$

---

## 本章复习要点

### 必背公式
1. 中点画线法初始判别式：$d_0 = 2a + b$
2. Bresenham画线法初始误差项：$e_0 = 2\Delta y - \Delta x$
3. 中点画圆法初始判别式：$d_0 = 1 - r$
4. 矢量点积：$\vec{u} \cdot \vec{v} = u_x v_x + u_y v_y + u_z v_z$
5. 矢量叉积：$(u_y v_z - u_z v_y, u_z v_x - u_x v_z, u_x v_y - u_y v_x)$

### 必会算法
1. 中点画线法：能够列表计算每一步
2. Bresenham画线法：能够列表计算每一步
3. 中点画圆法：能够列表计算每一步
4. 射线法判断点在多边形内：能够判断每条边的交点
5. 矢量运算：能够计算点积、模长、余弦值、叉积

### 答题技巧
1. **列表格**：所有递推算法都用表格形式，清晰明了
2. **写步骤**：即使不会做，也要写出算法步骤，可以得部分分
3. **检查符号**：特别注意正负号，很容易出错
4. **保留中间结果**：方便检查和得步骤分

### 常见易错点
1. 中点画线法：注意 $a = y_0 - y_1$（不是 $y_1 - y_0$）
2. Bresenham法：注意误差项的更新公式
3. 射线法：注意顶点和边重合的特殊情况
4. 矢量叉积：注意符号和顺序，第二项要取负

### 时间分配
- 每题6分钟，共30分钟
- 留5分钟检查

### 考前冲刺
1. 把去年的5道计算题做3遍
2. 把扩展练习题做1遍
3. 背诵所有公式
4. 练习列表格的速度
